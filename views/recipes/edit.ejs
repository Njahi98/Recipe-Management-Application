 <!DOCTYPE html>
<html lang="en">
  <%-include('../partials/head.ejs')%>
  <body>
    <%-include('../partials/nav.ejs')%>
    <div class="page-container">
      <div id="content-wrap">
        <img src="/images/banner2.jpg" alt="">
        <div class="recipeCenterImgText">
          <p>UPDATE RECIPE</p>
        </div>
        
        <form id="editForm" class="recipe-form" action="/recipes/<%= recipe._id %>" method="post" data-id="<%= recipe._id %>">          <div class="form-section">
            <label for="title">Recipe Title</label>
            <input type="text" id="title" name="title" value="<%=recipe.title %>" required>
          </div>

          <div class="form-section">
            <label for="description">Description</label>
            <textarea id="description" name="description" rows="4" required><%=recipe.description %></textarea>
          </div>

          <div class="form-section">
            <label for="image">Recipe Image</label>
            <input type="file" id="image" name="image" accept="image/*">
            <% if (recipe.imageId) { %>
              <div class="current-image">
                <img src="/recipes/image/<%= recipe.imageId %>" alt="Current recipe image" style="max-width: 200px;">
                <p>Current image</p>
              </div>
            <% } %>
          </div>

          <div class="form-row">
            <div class="form-section">
              <label for="cookingTime">Cooking Time(mins)</label>
              <input type="number" id="cookingTime" name="cookingTime" value="<%=recipe.cookingTime %>" required>
            </div>
            <div class="form-section">
              <label for="category">Category</label>
              <select id="category" name="category" required>
                <option value="Breakfast">Breakfast</option>
                <option value="Lunch">Lunch</option>
                <option value="Dinner">Dinner</option>
                <option value="Dessert">Dessert</option>
                <option value="Snack">Snack</option>
              </select>
            </div>
            <div class="form-section">
              <label for="difficulty">Difficulty</label>
              <select id="difficulty" name="difficulty" required>
                <option value="Easy">Easy</option>
                <option value="Medium">Medium</option>
                <option value="Hard">Hard</option>
              </select>
            </div>
          </div>

          <div class="form-section">
            <label>Ingredients</label>
            <div id="ingredients-container">
              
            </div>
            <button type="button" id="add-ingredient" class="add-btn">Add Ingredient</button>
          </div>

          <div class="form-section">
            <label>Instructions</label>
            <div id="instructions-container">
            </div>
            <button type="button" id="add-instruction" class="add-btn">Add Step</button>
          </div>

          <div class="form-actions">
            <button type="submit" class="submit-btn">Update Recipe</button>
            <a href="/recipes" class="cancel-btn">Cancel</a>
          </div>
        </form>
      </div>
    </div>
    <%-include('../partials/notification.ejs')%>
    <%-include('../partials/footer.ejs') %>

    <script>
      /*
      JS variables like <%= recipe.category %> are processed on the server-side and only exist in the .ejs file before
       the HTML is sent to the browser.Once the browser receives the HTML, these variables are
        no longer availableâ€”they've already been replaced by their values.

        We need a way to pass the required data
        (e.g., recipe.category, recipe.difficulty, recipe.ingredients) to JavaScript in the browser.
        
        We decided to inject Data Using a <script> Block
        We Directly embed a <script> block in EJS to pass variables to the external script
  */
      const recipeData = {
        category: "<%= recipe.category %>",
        difficulty: "<%= recipe.difficulty %>",
        ingredients: `<%- JSON.stringify(recipe.ingredients) %>`,
        instructions:`<%- JSON.stringify(recipe.instructions) %>`
      };
    </script>
    <script src="/scripts/recipe/recipes-edit.js"></script>
    
  </body>
</html>